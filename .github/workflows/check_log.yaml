name: ğŸ” Check Log

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Checking log error'
        required: true
        default: 'checking_log'

jobs:
  nginx_error:
    name: âŒ Log Error from Nginx Log
    runs-on: self-hosted

    steps:
      - name: ğŸ§ª Run Tail check script
        run: |
          tail /var/log/nginx/finance_error.log
  nginx_access:
    name: ğŸ” Log Access from Nginx Log
    runs-on: self-hosted

    steps:
      - name: ğŸ§ª Run Tail check script
        run: |
          tail /var/log/nginx/finance_access.log
  laravel_log:
    name: â„¹ï¸ Log Access or error from Laravel
    runs-on: self-hosted

    steps:
      - name: ğŸ§ª Run MySQL check script
        run: |
          LOG_DIR="/var/www/invoice/current/storage/logs/*.log"
          LOG_FILES=("$LOG_DIR"/*.log)

          # Check if files exist and are not literal "*.log"
          if [ -e "${LOG_FILES[0]}" ]; then
              tail -f "${LOG_FILES[@]}"
          else
              echo "ğŸ“ No .log files found in $LOG_DIR"
          fi
