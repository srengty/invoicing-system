import{_ as M}from"./GuestLayout-D6vfYlh4.js";import{n as q,c as G,a as d,b as H,d as v,e as u,f as s,g as a,m as J,h as r,i as t,P as K,j as R,k as p,l as W,t as V,y as c,p as h,F as _,x as Q,q as X}from"./app-bSMdDCtv.js";import{_ as Z}from"./ChooseColumns-CW1qHqxs.js";import{d as f}from"./index-CFxwmHLt.js";import{h as m}from"./moment-C5S46NFB.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{N as le}from"./NavbarLayout-B9VpbdtL.js";import{s as te}from"./index-DU88kvz-.js";import{s as C}from"./index-Ds-6aC4Y.js";import{s as g}from"./index-Dw0KrZvb.js";import{s as S}from"./index-BlOd25Hu.js";import{b as oe,c as y}from"./index-BVmUdKqC.js";/* empty css                                                    */import"./index-VTpc7zfg.js";import"./index-CRC9bhxM.js";import"./index-t9nxt4Sg.js";import"./index-CAdITkwZ.js";const se={class:"py-3"},ae={class:"invoices"},ne={class:"flex justify-end items-center"},ie={class:"flex gap-2"},re={class:"mb-8"},de={class:"grid gap-10 w-full grid-cols-4 text-sm mb-2"},ue={class:"grid grid-cols-2"},ce={class:"grid grid-cols-2"},me={class:"grid grid-cols-2"},ve={class:"grid gap-10 w-full grid-cols-4 text-sm mb-2"},pe={class:"grid grid-cols-2"},_e={class:"grid grid-cols-2"},fe={class:"grid grid-cols-2"},ge={class:"grid gap-10 w-full grid-cols-4 text-sm"},ye={class:"grid grid-cols-2"},be={class:"grid grid-cols-2"},we={class:"grid grid-cols-2"},Ve={class:"flex items-end gap-4 grid-cols-2"},he={class:"flex gap-2 justify-center"},Ce={__name:"Index",props:{invoices:{type:Object,required:!0}},setup(P){const z=q(),N=G(()=>[{label:"",to:"/",icon:"pi pi-home"},{label:z.props.title||"Invoices",to:route("invoices.index")}]),I=localStorage.getItem("invoiceFilters"),o=d(I?JSON.parse(I):{invoice_no_start:null,invoice_no_end:null,category_name_english:null,currency:null,start_date:null,end_date:null,customer:null,status:null,income_type:null}),$=d([{label:"Individual",value:"Individual"},{label:"Public Organization",value:"Public Organization"},{label:"NGO",value:"NGO"},{label:"Private Company",value:"Private Company"}]),O=d([{label:"USD",value:"USD"},{label:"KHR",value:"KHR"}]),b=[{field:"invoice_no",header:"Invoice No"},{field:"date",header:"Date"},{field:"due_date",header:"Due Date"},{field:"customer.name",header:"Customer"},{field:"grand_total",header:"Amount"},{field:"agreement.amount",header:"Amount Paid"},{field:"status",header:"Status"}],w=d(b.slice()),x=d(b),U=d([{label:"Paid",value:"Paid"},{label:"Pending",value:"Pending"},{label:"Cancelled",value:"Cancelled"}]),F=()=>{x.value=w.value},T=()=>{f.Inertia.visit("/invoices/create")},E=n=>{f.Inertia.visit(`/invoices/${n}/edit`)},Y=n=>{confirm("Are you sure you want to delete this invoice?")&&f.Inertia.delete(`/invoices/${n}`)},A=n=>{if(!n.due_date)return"-";const e=m(n.due_date),l=m().diff(e,"days");return l>0?l:0},L=n=>{const e=`/invoices/${n}`,i=window.open(e,"_blank");setTimeout(()=>{i.print()},1e3)},k=()=>{const n=o.value.start_date?m(o.value.start_date).format("YYYY-MM-DD"):null,e=o.value.end_date?m(o.value.end_date).format("YYYY-MM-DD"):null,i={invoice_no_start:o.value.invoice_no_start,invoice_no_end:o.value.invoice_no_end,category_name_english:o.value.category_name_english,currency:o.value.currency,start_date:n,end_date:e,customer:o.value.customer,status:o.value.status,income_type:o.value.income_type};localStorage.setItem("invoiceFilters",JSON.stringify(i)),f.Inertia.get("/invoices",i)},j=()=>{o.value={invoice_no_start:null,invoice_no_end:null,category_name_english:null,currency:null,start_date:null,end_date:null,customer:null,status:null},k()},B=n=>{var l;const e=n.grand_total||0,i=((l=n.agreement)==null?void 0:l.amount)||0;return(e-i).toFixed(2)};return(n,e)=>{const i=H("keyfilter");return u(),v(_,null,[s(a(J),{title:"Invoices"}),s(M,null,{default:r(()=>[s(le),t("div",se,[s(a(te),{model:N.value,class:"border-none bg-transparent p-0"},{item:r(({item:l})=>[s(a(K),{href:l.to,class:"text-sm hover:text-primary flex items-start justify-center gap-1"},{default:r(()=>[l.icon?(u(),v("i",{key:0,class:W(l.icon)},null,2)):R("",!0),p(" "+V(l.label),1)]),_:2},1032,["href"])]),_:1},8,["model"])]),t("div",ae,[t("div",ne,[t("div",ie,[s(a(c),{icon:"pi pi-plus",label:"Create Invoice",size:"small",onClick:T}),s(Z,{columns:b,modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=l=>w.value=l),onApply:F,size:"small"},null,8,["modelValue"])])]),t("div",re,[e[18]||(e[18]=t("div",{class:"text-md font-semibold mb-3"},"Filter by",-1)),t("div",de,[t("div",ue,[e[9]||(e[9]=t("label",{class:"grid content-center",for:"invoice_no_start"},"Invoice No. Start:",-1)),h(s(a(C),{modelValue:o.value.invoice_no_start,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.invoice_no_start=l),placeholder:"Input Invoice No Start",size:"small",class:"w-full md:w-44"},null,8,["modelValue"]),[[i,["num"]]])]),t("div",ce,[e[10]||(e[10]=t("label",{class:"grid content-center",for:"invoice_no_end"},"Invoice No. End:",-1)),h(s(a(C),{modelValue:o.value.invoice_no_end,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.invoice_no_end=l),placeholder:"Input Invoice No End",size:"small",class:"w-full md:w-44"},null,8,["modelValue"]),[[i,["num"]]])]),t("div",me,[e[11]||(e[11]=t("label",{class:"grid content-center",for:"currency"},"Currency:",-1)),s(a(g),{modelValue:o.value.currency,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.currency=l),options:O.value,placeholder:"Select Currency",optionLabel:"label",optionValue:"value",size:"small",class:"w-full md:w-44"},null,8,["modelValue","options"])])]),t("div",ve,[t("div",pe,[e[12]||(e[12]=t("label",{class:"grid content-center",for:"start_date"},"Start Date:",-1)),s(a(S),{modelValue:o.value.start_date,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.start_date=l),placeholder:"Pick Start Date",size:"small",class:"w-full md:w-44"},null,8,["modelValue"])]),t("div",_e,[e[13]||(e[13]=t("label",{class:"grid content-center",for:"end_date"},"End Date:",-1)),s(a(S),{modelValue:o.value.end_date,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.end_date=l),placeholder:"Pick End Date",size:"small",class:"w-full md:w-44"},null,8,["modelValue"])]),t("div",fe,[e[14]||(e[14]=t("label",{class:"grid content-center",for:"status"},"Payment Status:",-1)),s(a(g),{modelValue:o.value.status,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.status=l),options:U.value,placeholder:"Select Status",optionLabel:"label",optionValue:"value",size:"small",class:"w-full md:w-44"},null,8,["modelValue","options"])])]),t("div",ge,[t("div",ye,[e[15]||(e[15]=t("label",{class:"grid content-center",for:"customer"},"Customer:",-1)),h(s(a(C),{modelValue:o.value.customer,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.customer=l),placeholder:"Input Customer Name",size:"small",class:"w-full md:w-44"},null,8,["modelValue"]),[[i,["alpha"]]])]),t("div",be,[e[16]||(e[16]=t("label",{class:"grid content-center",for:"category_name_english"},"Customer Type:",-1)),s(a(g),{modelValue:o.value.category_name_english,"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.category_name_english=l),options:$.value,placeholder:"Select Customer Type",optionLabel:"label",optionValue:"value",size:"small",class:"w-full md:w-44"},null,8,["modelValue","options"])]),t("div",we,[e[17]||(e[17]=t("label",{class:"grid content-center",for:"income_type"},"Income Type:",-1)),s(a(g),{placeholder:"Select Income Type",optionLabel:"label",optionValue:"value",size:"small",class:"w-full md:w-44"})]),t("div",Ve,[s(a(c),{label:"Search",icon:"pi pi-search",onClick:k,size:"small",class:"w-full md:w-32 shadow-md"}),s(a(c),{label:"Clear",icon:"pi pi-times",severity:"secondary",onClick:j,size:"small",class:"w-full md:w-32 shadow-md"})])])]),s(a(oe),{value:P.invoices.data,paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],size:"small",class:"text-sm"},{default:r(()=>[(u(!0),v(_,null,Q(x.value,l=>(u(),X(a(y),{class:"",key:l.field,field:l.field,header:l.header,sortable:""},null,8,["field","header"]))),128)),s(a(y),{header:"Amount Due"},{body:r(({data:l})=>[a(m)(l.due_date).isBefore(a(m)(),"day")?(u(),v(_,{key:0},[p(V(B(l)),1)],64)):(u(),v(_,{key:1},[p(" Not past due ")],64))]),_:1}),s(a(y),{header:"Overdue"},{body:r(({data:l})=>[p(V(A(l))+" days ago ",1)]),_:1}),s(a(y),{header:"Actions",headerStyle:"text-align: center",bodyStyle:"text-align: center"},{body:r(({data:l})=>[t("div",he,[s(a(c),{icon:"pi pi-print",class:"p-button-info","aria-label":"Print",onClick:D=>L(l.invoice_no),rounded:""},null,8,["onClick"]),s(a(c),{icon:"pi pi-pencil",class:"p-button-warning","aria-label":"Edit",onClick:D=>E(l.invoice_no),rounded:""},null,8,["onClick"]),s(a(c),{icon:"pi pi-trash",class:"p-button-danger","aria-label":"Delete",onClick:D=>Y(l.invoice_no),rounded:""},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])])]),_:1})],64)}}},je=ee(Ce,[["__scopeId","data-v-b771d083"]]);export{je as default};
