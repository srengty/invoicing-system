import{n as A,C as L,a as V,c as y,d as k,e as q,i as l,f as a,g as t,m as j,h as u,y as p,_ as D,t as x,X as B,j as F,F as Q}from"./app-DZTdZYTv.js";import{_ as G}from"./GuestLayout-BfdKZXvL.js";import{d as w}from"./index-B9TghNQy.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as f,a as v}from"./index-BFVOh3Gg.js";import{s as C}from"./index-DmsJMzp3.js";import{b as S,c as i}from"./index-Dm6_jG8z.js";/* empty css                                                    */import"./index-Ch5aU8qY.js";import"./index-DRzkQ_aZ.js";import"./index-CHXn2h8A.js";import"./index-B9Lb2ArG.js";const O={class:"create-invoice"},X={class:"flex justify-between items-center p-3 mr-4"},z={class:"flex gap-4"},H={class:"p-3 grid grid-cols-1 md:grid-cols-3 gap-4 ml-4 mr-4"},J={class:"m-6"},K={class:"total-container mt-4 flex justify-between"},R={class:"font-bold"},W={class:"grand-total-container flex justify-between"},Y={class:"font-bold text-lg"},Z={class:"buttons mt-4 flex justify-end"},ee={class:"product-list"},te={key:0},le={__name:"Edit",setup(oe){const{invoice:d,products:b,agreements:T,quotations:U,customers:E}=A().props,n=L({invoice_no:d.invoice_no||"",agreement_no:d.agreement_no||"",quotation_no:d.quotation_no||"",customer_id:d.customer_id||"",address:d.address||"",phone:d.phone||"",start_date:d.start_date||"",end_date:d.end_date||"",grand_total:d.grand_total||0,status:d.status||""}),P=[{label:"Pending",value:"pending"},{label:"Paid",value:"paid"},{label:"Cancelled",value:"cancelled"}],r=V([...d.products]),m=V(!1),$=s=>{r.value.push({id:s.id,product:s.name,qty:1,unit:s.unit,unitPrice:s.price,subTotal:1*s.price}),m.value=!1},I=s=>{s.subTotal=s.qty*s.price},_=y(()=>r.value.reduce((s,e)=>s+e.subTotal,0)),h=y(()=>_.value),g=async()=>{if(r.value.length===0){alert("Please add at least one product.");return}const s=r.value.reduce((o,c)=>o+c.subTotal,0),e={invoice_no:n.invoice_no,agreement_no:n.agreement_no,quotation_no:n.quotation_no,customer_id:n.customer_id,address:n.address,phone:n.phone,start_date:n.start_date,end_date:n.end_date,grand_total:s,status:n.status,products:r.value.map(o=>({id:o.id,quantity:o.qty}))};console.log("invoiceData: ",e);try{await n.put(`/invoices/${d.id}`,e,{onSuccess:()=>{alert("Invoice updated successfully!"),w.Inertia.visit("/invoices")},onError:o=>{alert("Error updating invoice: "+(o.message||"Unknown error"))}})}catch(o){console.error("Error:",o),alert("There was an error updating the invoice.")}},N=()=>{w.Inertia.visit("/invoices")};return(s,e)=>(q(),k(Q,null,[e[25]||(e[25]=l("meta",{name:"csrf-token",content:"{{ csrf_token() }}"},null,-1)),a(t(j),{title:"Edit Invoice"}),a(G,null,{default:u(()=>[l("div",O,[l("div",X,[e[12]||(e[12]=l("h1",{class:"text-2xl"},"Edit Invoice",-1)),l("div",z,[l("div",null,[a(t(p),{label:"Add Product",icon:"pi pi-plus",class:"p-button-success",type:"button",onClick:e[0]||(e[0]=o=>m.value=!0),rounded:""})]),l("div",null,[a(t(p),{label:"Save Changes",icon:"pi pi-check",class:"p-button-success",type:"button",onClick:g,rounded:""})])])]),l("form",{onSubmit:D(g,["prevent"])},[l("div",H,[l("div",null,[e[13]||(e[13]=l("label",{for:"invoice_no",class:"block text-lg font-medium"},"Invoice No",-1)),a(t(f),{id:"invoice_no",modelValue:t(n).invoice_no,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).invoice_no=o),class:"w-full",placeholder:"Enter invoice number",required:""},null,8,["modelValue"])]),l("div",null,[e[14]||(e[14]=l("label",{for:"customer_id",class:"block text-lg font-medium"},"Customer",-1)),a(t(v),{modelValue:t(n).customer_id,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).customer_id=o),options:t(E),optionLabel:"name",optionValue:"id",placeholder:"Select Customer",class:"w-full",required:""},null,8,["modelValue","options"])]),l("div",null,[e[15]||(e[15]=l("label",{for:"agreement_no",class:"block text-lg font-medium"},"Agreement No",-1)),a(t(v),{modelValue:t(n).agreement_no,"onUpdate:modelValue":e[3]||(e[3]=o=>t(n).agreement_no=o),options:t(T),optionLabel:"agreement_no",optionValue:"agreement_no",placeholder:"Select Agreement",class:"w-full",required:""},null,8,["modelValue","options"])]),l("div",null,[e[16]||(e[16]=l("label",{for:"quotation_no",class:"block text-lg font-medium"},"Quotation No",-1)),a(t(v),{modelValue:t(n).quotation_no,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).quotation_no=o),options:t(U),optionLabel:"quotation_no",optionValue:"id",placeholder:"Select Quotation",class:"w-full",required:""},null,8,["modelValue","options"])]),l("div",null,[e[17]||(e[17]=l("label",{for:"status",class:"block text-lg font-medium"},"Status",-1)),a(t(v),{modelValue:t(n).status,"onUpdate:modelValue":e[5]||(e[5]=o=>t(n).status=o),options:P,optionLabel:"label",optionValue:"value",placeholder:"Select Status",class:"w-full",required:""},null,8,["modelValue"])]),l("div",null,[e[18]||(e[18]=l("label",{for:"address",class:"block text-lg font-medium"},"Address",-1)),a(t(f),{id:"address",modelValue:t(n).address,"onUpdate:modelValue":e[6]||(e[6]=o=>t(n).address=o),class:"w-full",placeholder:"Enter address"},null,8,["modelValue"])]),l("div",null,[e[19]||(e[19]=l("label",{for:"phone",class:"block text-lg font-medium"},"Phone",-1)),a(t(f),{id:"phone",modelValue:t(n).phone,"onUpdate:modelValue":e[7]||(e[7]=o=>t(n).phone=o),class:"w-full",placeholder:"Enter phone number"},null,8,["modelValue"])]),l("div",null,[e[20]||(e[20]=l("label",{for:"start_date",class:"block text-lg font-medium"},"Start Date",-1)),a(t(C),{id:"start_date",modelValue:t(n).start_date,"onUpdate:modelValue":e[8]||(e[8]=o=>t(n).start_date=o),class:"w-full",placeholder:"Select start date"},null,8,["modelValue"])]),l("div",null,[e[21]||(e[21]=l("label",{for:"end_date",class:"block text-lg font-medium"},"End Date",-1)),a(t(C),{id:"end_date",modelValue:t(n).end_date,"onUpdate:modelValue":e[9]||(e[9]=o=>t(n).end_date=o),class:"w-full",placeholder:"Select end date"},null,8,["modelValue"])])])],32),l("div",J,[a(t(S),{value:r.value,class:"p-datatable-striped",responsiveLayout:"scroll"},{default:u(()=>[a(t(i),{field:"id",header:"No.",body:s.indexTemplate},null,8,["body"]),a(t(i),{field:"name",header:"Product",body:s.productBody},null,8,["body"]),a(t(i),{field:"qty",header:"Qty"},{body:u(o=>[a(t(f),{modelValue:o.data.qty,"onUpdate:modelValue":c=>o.data.qty=c,onInput:c=>I(o.data),class:"w-full"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),a(t(i),{field:"unit",header:"Unit"}),a(t(i),{field:"price",header:"Unit Price"}),a(t(i),{field:"subTotal",header:"Sub Total"}),a(t(i),{header:"Action",body:s.actionTemplate},null,8,["body"])]),_:1},8,["value"]),l("div",K,[e[22]||(e[22]=l("p",{class:"font-bold"},"Total",-1)),l("p",R,x(_.value),1)]),l("div",W,[e[23]||(e[23]=l("p",{class:"font-bold text-lg"},"Grand Total",-1)),l("p",Y,x(h.value),1)]),e[24]||(e[24]=l("div",{class:"terms mt-4"},[l("h3",{class:"text-lg"},"Terms and Conditions"),l("p",null,"Full payment is required upon quote acceptance."),l("p",null,"This quote is negotiable for one (1) week from the date stated above.")],-1)),l("div",Z,[a(t(p),{label:"Submit request for approval",icon:"pi pi-check",class:"p-button-rounded p-button-success",onClick:g}),a(t(p),{label:"Cancel",class:"p-button-rounded p-button-secondary ml-2",onClick:N})])]),a(t(B),{visible:m.value,"onUpdate:visible":e[11]||(e[11]=o=>m.value=o),header:"Select Product"},{footer:u(()=>[a(t(p),{label:"Close",icon:"pi pi-times",class:"p-button-text",onClick:e[10]||(e[10]=o=>m.value=!1)})]),default:u(()=>[l("div",ee,[!t(b)||t(b).length===0?(q(),k("p",te,"No products available.")):F("",!0),a(t(S),{value:t(b),class:"p-datatable-striped",responsiveLayout:"scroll"},{default:u(()=>[a(t(i),{field:"name",header:"Product Name"}),a(t(i),{field:"unit",header:"Unit"}),a(t(i),{field:"price",header:"Price"}),a(t(i),{header:"Action"},{body:u(o=>[a(t(p),{label:"Add",icon:"pi pi-plus",class:"p-button-text p-button-success",onClick:c=>$(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),_:1},8,["visible"])])]),_:1})],64))}},be=M(le,[["__scopeId","data-v-ef0c954a"]]);export{be as default};
